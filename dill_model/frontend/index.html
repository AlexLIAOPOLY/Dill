<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title data-i18n="title">多模型光刻胶计算工具</title>
    <!-- 引入Google字体 -->
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
    <!-- 引入样式文件 -->
    <link rel="stylesheet" href="css/style.css?v=1.1">
    <link rel="stylesheet" href="css/animations.css?v=1.1">
    <link rel="stylesheet" href="css/popup-enhanced.css?v=1.0">
    <link rel="stylesheet" href="css/car-model.css?v=1.0">
    <link rel="stylesheet" href="css/loading-animation.css">
    <link rel="stylesheet" href="css/theme-colors.css?v=1.0">
    <!-- 添加数学公式所需的样式 -->
    <style>
        /* 分数样式 */
        .fraction {
            display: inline-block;
            vertical-align: middle;
            text-align: center;
            margin: 0 4px;
            font-size: 1.05em;
        }
        
        .numerator, .denominator {
            display: block;
            padding: 0 4px;
        }
        
        .numerator {
            border-bottom: 1.5px solid black;
            margin-bottom: 1px;
            padding-bottom: 1px;
        }
        
        /* 确保数学符号与文本间距适宜 */
        code sup, code sub {
            font-size: 75%;
            line-height: 0;
            position: relative;
        }
        
        code sup {
            top: -0.5em;
        }
        
        code sub {
            bottom: -0.25em;
        }
        
        /* 美化数学公式样式 */
        code {
            font-family: "Times New Roman", serif;
            font-size: 1.05em;
            white-space: nowrap;
            letter-spacing: 0.3px;
        }
        
        /* 相位表达式选择器样式 */
        .phi-expr-container {
            display: flex;
            flex-direction: column;
            gap: 6px;
        }
        
        .phi-expr-select {
            padding: 6px 8px;
            border-radius: 4px;
            border: 1px solid #ccc;
            background-color: #f9f9f9;
            width: 100%;
            font-size: 0.9em;
            cursor: pointer;
        }
        
        .phi-expr-input {
            padding: 6px 8px;
            border-radius: 4px;
            border: 1px solid #ccc;
            width: 100%;
            font-size: 0.95em;
        }
        
        .phi-expr-select:focus,
        .phi-expr-input:focus {
            border-color: var(--accent-color, #3498db);
            outline: none;
            box-shadow: 0 0 0 2px rgba(52, 152, 219, 0.2);
        }

        /* 主题特定颜色 */
        .theme-dill .phi-expr-select:focus,
        .theme-dill .phi-expr-input:focus {
            border-color: var(--dill-accent-color);
            box-shadow: 0 0 0 2px rgba(52, 152, 219, 0.2);
        }
        
        .theme-enhanced-dill .phi-expr-select:focus,
        .theme-enhanced-dill .phi-expr-input:focus {
            border-color: var(--enhanced-dill-accent-color);
            box-shadow: 0 0 0 2px rgba(155, 89, 182, 0.2);
        }
        
        .theme-car .phi-expr-select:focus,
        .theme-car .phi-expr-input:focus {
            border-color: var(--car-accent-color);
            box-shadow: 0 0 0 2px rgba(230, 126, 34, 0.2);
        }
    </style>
    <!-- 引入Plotly.js -->
    <script src="https://cdn.plot.ly/plotly-2.25.2.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- 引入系统化日志管理 -->
    <script src="js/systematic-logs.js?v=1.0"></script>
</head>
<body>
    <!-- 加载动画 -->
    <div id="loading" class="loading">
        <!-- 加载页面右上角日志按钮 -->
        <div class="loading-controls">
            <button id="loading-logs-btn" class="loading-logs-btn" title="查看计算进度" data-i18n-title="loading_logs_title">
                <i class="fas fa-file-alt"></i>
                <span class="loading-logs-text" data-i18n="loading_logs">计算日志</span>
            </button>
        </div>
        
        <!-- 加载期间的日志显示面板 -->
        <div id="loading-logs-panel" class="loading-logs-panel">
            <div class="loading-logs-header">
                <h4 class="loading-logs-title">
                    <i class="fas fa-code"></i>
                    <span data-i18n="loading_logs_title_text">实时计算日志</span>
                </h4>
                <div class="loading-logs-controls">
                    <button id="loading-logs-minimize" class="loading-logs-control-btn" title="最小化">
                        <i class="fas fa-minus"></i>
                    </button>
                    <button id="loading-logs-close" class="loading-logs-control-btn" title="关闭">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
            </div>
            <div class="loading-logs-content">
                <div class="loading-logs-stats">
                    <div class="loading-stat">
                        <span class="stat-label" data-i18n="loading_stat_progress">进度:</span>
                        <span id="loading-progress-text" class="stat-value">等待开始...</span>
                    </div>
                    <div class="loading-stat">
                        <span class="stat-label" data-i18n="loading_stat_time">用时:</span>
                        <span id="loading-time-text" class="stat-value">-</span>
                    </div>
                </div>
                <div id="loading-logs-container" class="loading-logs-list">
                    <div class="loading-logs-placeholder">
                        <i class="fas fa-info-circle"></i>
                        <span data-i18n="loading_logs_placeholder">计算开始后将显示详细日志...</span>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="loader-container">
            <!-- 多层旋转环 -->
            <div class="spinner-ring"></div>
            <div class="spinner-ring"></div>
            <div class="spinner-ring"></div>
            
            <!-- 中心圆点 -->
            <div class="spinner-core"></div>
            
            <!-- 波浪效果 -->
            <div class="wave"></div>
            <div class="wave"></div>
            <div class="wave"></div>
            
            <!-- 粒子效果 -->
            <div class="particles">
                <div class="particle"></div>
                <div class="particle"></div>
                <div class="particle"></div>
                <div class="particle"></div>
                <div class="particle"></div>
                <div class="particle"></div>
            </div>
            
            <!-- 分子路径 -->
            <div class="molecule-path">
                <div class="path"><div class="molecule"></div></div>
                <div class="path"><div class="molecule"></div></div>
                <div class="path"><div class="molecule"></div></div>
                <div class="path"><div class="molecule"></div></div>
            </div>
        </div>
        <div class="loading-text" data-i18n="loading">加载中...</div>
    </div>
    
    <!-- 页头 -->
    <header>
        <div class="header-content">
            <div class="logo" data-i18n="logo"><span>多模型</span>计算工具</div>
            <nav class="main-nav">
                <ul>
                    <li class="active"><a href="index.html" data-i18n="nav_single">单一计算</a></li>
                    <li><a href="compare.html" data-i18n="nav_compare">参数比较</a></li>
                    <li><a href="/matrix_visualization/" data-i18n="nav_matrix">模型矩阵可视化</a></li>
                </ul>
            </nav>
            <div class="lang-switcher">
                <button id="lang-toggle-btn" data-i18n="lang_btn">English/中文</button>
            </div>
        </div>
    </header>
    
    <!-- 主要内容 -->
    <main class="main-content">
        <div class="container">
            <!-- 错误消息 -->
            <div id="error-message" class="error-message" data-i18n="error_message"></div>

            <!-- 模型选择与公式展示区域 -->
            <section id="model-selection-section" class="model-selection-section">
                <h2 class="section-title">模型选择与说明</h2>
                <div class="model-selector-container">
                    <label for="model-select" class="model-select-label" data-i18n="select_model">选择计算模型:</label>
                    <select id="model-select" class="model-select">
                        <option value="dill" selected data-i18n="dill_model">Dill模型（薄胶）</option>
                        <option value="enhanced_dill" data-i18n="enhanced_dill_model">增强Dill模型（厚胶）</option>
                        <option value="car" data-i18n="car_model">CAR模型（化学放大型光刻胶）</option>
                    </select>
                </div>

                <div id="model-description-container" class="model-description-container">
                    <div id="dill-desc" class="model-card" style="display:block;">
                        <h3 class="model-description-title">
                            <i class="fas fa-microscope"></i>
                            <span data-i18n="dill_formula_title">Dill模型</span>
                        </h3>
                        <div class="model-core-formula" data-i18n="dill_formula_core">核心关系: <code>M(x,z) = e<sup>-C · D(x,z)</sup></code></div>
                        <p class="formula-notation" data-i18n="dill_formula_note"><em>M: 归一化光敏剂浓度, C: 光敏速率常数, D: 曝光剂量</em></p>
                        <div class="model-math"></div>
                        <div class="model-ref"></div>
                        <button id="dill-toggle-details" class="toggle-details-btn" data-i18n="btn_expand">展开更多 <i class="fas fa-chevron-down"></i></button>
                        <div id="dill-full-details" class="model-full-details">
                            <h4 data-i18n="dill_formula_ode">微分方程</h4>
                            <code style="display:block;margin-bottom:10px;" data-i18n="dill_formula_ode_code">
                                <div class="fraction">
                                    <span class="numerator">∂M</span>
                                    <span class="denominator">∂t</span>
                                </div>
                                 = -C · I · M
                            </code>
                            <div style="color:#34495e;font-size:0.98rem;margin-bottom:12px;" data-i18n="dill_formula_ref">参考：Dill F H, Neureuther A R, Tuttle J A, et al. IEEE Trans Electron Devices, 1975.</div>
                            <h4 data-i18n="dill_formula_scope">Dill模型主要适用于薄胶层（< 3μm）的光刻胶曝光过程建模，其中光的穿透性较好，光强分布较为均匀。</h4>
                            <h4 data-i18n="dill_formula_math">完整的Dill模型包括三个关键参数A、B、C：</h4>
                            <ul>
                                <li data-i18n="dill_formula_math_A"><b>参数A</b>：表示光敏剂对光的吸收率</li>
                                <li data-i18n="dill_formula_math_B"><b>参数B</b>：表示基底对光的吸收率</li>
                                <li data-i18n="dill_formula_math_C"><b>参数C</b>：表示光敏剂对光的反应速率</li>
                            </ul>
                            <p data-i18n="dill_formula_simple">在本工具的简化模型中，主要使用参数C来表征光刻胶的曝光特性。</p>
                            <h4 data-i18n="dill_formula_detail">核心公式详解</h4>
                            <div class="formula-details-card inner-formula-card">
                                <div class="formula-card-body">
                                    <div class="formula-large" data-i18n="dill_formula_core"><code>M(x,z) = e<sup>-C · D(x,z)</sup></code></div>
                                    <div class="formula-description">
                                        <div class="formula-param" data-i18n="dill_formula_param_M"><span class="param-name">M(x,z):</span> <span class="param-desc">位置(x,z)处的归一化光敏剂浓度，M=1表示未曝光区域，M=0表示完全曝光区域</span></div>
                                        <div class="formula-param" data-i18n="dill_formula_param_C"><span class="param-name">C:</span> <span class="param-desc">光敏速率常数，表示光刻胶对光的敏感程度，单位: cm²/mJ</span></div>
                                        <div class="formula-param" data-i18n="dill_formula_param_D"><span class="param-name">D(x,z):</span> <span class="param-desc">位置(x,z)处的曝光剂量，单位: mJ/cm²</span></div>
                                    </div>
                                    <div class="formula-derivation">
                                        <h4 data-i18n="dill_formula_ode2">微分方程形式</h4>
                                        <code data-i18n="dill_formula_ode2_code">∂M/∂t = -C · I · M</code>
                                        <p data-i18n="dill_formula_ode2_note">其中I为光强度，表示单位时间内的曝光剂量。</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div id="enhanced-dill-desc" class="model-card" style="display:none;">
                        <h3 class="model-description-title">
                            <i class="fas fa-layer-group"></i>
                            <span data-i18n="enhanced_formula_title">增强Dill模型（厚胶）</span>
                        </h3>
                        <div class="model-core-formula" data-i18n="enhanced_formula_core">核心关系: <code>
                            <div class="fraction">
                                <span class="numerator">∂I</span>
                                <span class="denominator">∂z</span>
                            </div>
                            = -I · [A(z<sub>h</sub>,T,t<sub>B</sub>) · M + B(z<sub>h</sub>,T,t<sub>B</sub>)]
                        </code></div>
                        <p class="formula-notation" data-i18n="enhanced_formula_note"><em>A: 光敏剂吸收率, B: 基底吸收率, M: 归一化光敏剂浓度</em></p>
                        <div class="model-math"></div>
                        <div class="model-ref"></div>
                        <button id="enhanced-dill-toggle-details" class="toggle-details-btn" data-i18n="btn_expand">展开更多 <i class="fas fa-chevron-down"></i></button>
                        <div id="enhanced-dill-full-details" class="model-full-details">
                            <h4 data-i18n="enhanced_formula_ode">微分方程</h4>
                            <code style="display:block;margin-bottom:10px;" data-i18n="enhanced_formula_ode_code">
                                <div class="fraction">
                                    <span class="numerator">∂I</span>
                                    <span class="denominator">∂z</span>
                                </div>
                                = -I · [A(z<sub>h</sub>,T,t<sub>B</sub>) · M + B(z<sub>h</sub>,T,t<sub>B</sub>)]<br>
                                <div class="fraction">
                                    <span class="numerator">∂M</span>
                                    <span class="denominator">∂t</span>
                                </div>
                                = -I · M · C(z<sub>h</sub>,T,t<sub>B</sub>)
                            </code>
                            <div style="color:#34495e;font-size:0.98rem;margin-bottom:12px;" data-i18n="enhanced_formula_ref">参考：刘世杰等《厚层抗蚀剂曝光模型及其参数测量》, 2005.</div>
                            <h4 data-i18n="enhanced_formula_scope">该模型特别适用于厚胶层（> 5μm）光刻胶，其中光的穿透性受到明显影响，光强随深度衰减较为显著。</h4>
                            <h4 data-i18n="enhanced_formula_fit">参数拟合</h4>
                            <p data-i18n="enhanced_formula_fit_math">根据刘世杰等的研究，A/B/C参数可以通过以下形式表示：</p>
                            <ul>
                                <li data-i18n="enhanced_formula_fit_A">A(z<sub>h</sub>,T,t<sub>B</sub>) = a<sub>0</sub> + a<sub>1</sub> · z<sub>h</sub> + a<sub>2</sub> · T + a<sub>3</sub> · z<sub>h</sub><sup>2</sup> + a<sub>4</sub> · z<sub>h</sub> · T + a<sub>5</sub> · T<sup>2</sup></li>
                                <li data-i18n="enhanced_formula_fit_B">B(z<sub>h</sub>,T,t<sub>B</sub>) = b<sub>0</sub> + b<sub>1</sub> · z<sub>h</sub> + b<sub>2</sub> · T</li>
                                <li data-i18n="enhanced_formula_fit_C">C(z<sub>h</sub>,T,t<sub>B</sub>) = c<sub>0</sub> + c<sub>1</sub> · z<sub>h</sub> + c<sub>2</sub> · T + c<sub>3</sub> · z<sub>h</sub><sup>2</sup></li>
                            </ul>
                            <p data-i18n="enhanced_formula_fit_note">其中参数a₀~a₅, b₀~b₂, c₀~c₃由实验数据拟合得到。</p>
                            <h4 data-i18n="enhanced_formula_detail">核心公式详解</h4>
                            <div class="formula-details-card inner-formula-card">
                                <div class="formula-card-body">
                                    <div class="formula-large" data-i18n="enhanced_formula_core">
                                        <code>
                                            <div class="fraction">
                                                <span class="numerator">∂I</span>
                                                <span class="denominator">∂z</span>
                                            </div>
                                            = -I · [A(z<sub>h</sub>,T,t<sub>B</sub>) · M + B(z<sub>h</sub>,T,t<sub>B</sub>)]
                                        </code>
                                    </div>
                                    <div class="formula-large" data-i18n="enhanced_formula_core2">
                                        <code>
                                            <div class="fraction">
                                                <span class="numerator">∂M</span>
                                                <span class="denominator">∂t</span>
                                            </div>
                                            = -I · M · C(z<sub>h</sub>,T,t<sub>B</sub>)
                                        </code>
                                    </div>
                                    <div class="formula-description">
                                        <div class="formula-param" data-i18n="enhanced_formula_param_I"><span class="param-name">I:</span> <span class="param-desc">光强度，随深度z变化</span></div>
                                        <div class="formula-param" data-i18n="enhanced_formula_param_M"><span class="param-name">M:</span> <span class="param-desc">归一化光敏剂浓度</span></div>
                                        <div class="formula-param" data-i18n="enhanced_formula_param_A"><span class="param-name">A(z<sub>h</sub>,T,t<sub>B</sub>):</span> <span class="param-desc">光敏剂吸收率，与胶厚、前烘温度、前烘时间相关</span></div>
                                        <div class="formula-param" data-i18n="enhanced_formula_param_B"><span class="param-name">B(z<sub>h</sub>,T,t<sub>B</sub>):</span> <span class="param-desc">基底吸收率，与胶厚、前烘温度、前烘时间相关</span></div>
                                        <div class="formula-param" data-i18n="enhanced_formula_param_C"><span class="param-name">C(z<sub>h</sub>,T,t<sub>B</sub>):</span> <span class="param-desc">光敏速率常数，与胶厚、前烘温度、前烘时间相关</span></div>
                                    </div>
                                    <div class="formula-derivation">
                                        <h4 data-i18n="enhanced_formula_fit_detail">参数拟合公式</h4>
                                        <p data-i18n="enhanced_formula_fit_desc">A、B、C参数通过多项式函数拟合实验数据：</p>
                                        <code data-i18n="enhanced_formula_fit_A">A(z<sub>h</sub>,T,t<sub>B</sub>) = a<sub>0</sub> + a<sub>1</sub> · z<sub>h</sub> + a<sub>2</sub> · T + a<sub>3</sub> · z<sub>h</sub><sup>2</sup> + a<sub>4</sub> · z<sub>h</sub> · T + a<sub>5</sub> · T<sup>2</sup></code><br>
                                        <code data-i18n="enhanced_formula_fit_B">B(z<sub>h</sub>,T,t<sub>B</sub>) = b<sub>0</sub> + b<sub>1</sub> · z<sub>h</sub> + b<sub>2</sub> · T</code><br>
                                        <code data-i18n="enhanced_formula_fit_C">C(z<sub>h</sub>,T,t<sub>B</sub>) = c<sub>0</sub> + c<sub>1</sub> · z<sub>h</sub> + c<sub>2</sub> · T + c<sub>3</sub> · z<sub>h</sub><sup>2</sup></code>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div id="car-desc" class="model-card" style="display:none;">
                        <h3 class="model-description-title">
                            <i class="fas fa-flask"></i>
                            <span data-i18n="car_formula_title">CAR模型（化学放大型光刻胶）</span>
                        </h3>
                        <div class="model-core-formula" data-i18n="car_formula_core">核心关系: <code>[H<sup>+</sup>] = η · D(x)</code></div>
                        <p class="formula-notation" data-i18n="car_formula_note"><em>η: 光酸产生效率, D: 曝光剂量, [H<sup>+</sup>]: 光酸浓度</em></p>
                        <div class="model-math"></div>
                        <div class="model-ref"></div>
                        <button id="car-toggle-details" class="toggle-details-btn" data-i18n="btn_expand">展开更多 <i class="fas fa-chevron-down"></i></button>
                        <div id="car-full-details" class="model-full-details">
                            <h4 data-i18n="car_formula_ode">关键方程</h4>
                            <code style="display:block;margin-bottom:10px;" data-i18n="car_formula_ode_code">[H<sup>+</sup>] = η · D(x)<br>D(x,t) = I(x) · t<br>扩散: [H<sup>+</sup>]<sub>diff</sub> = G([H<sup>+</sup>], l<sub>diff</sub>)<br>脱保护度: M = 1 - e<sup>-k · [H<sup>+</sup>]<sub>diff</sub> · A</sup></code>
                            <div style="color:#34495e;font-size:0.98rem;margin-bottom:12px;" data-i18n="car_formula_ref">参考：Hinsberg et al., "Chemical amplification mechanism", Proc. SPIE, 1994.</div>
                            <h4 data-i18n="car_formula_scope">该模型特别适用于DUV (深紫外)光刻胶，其中一个光子可以通过光酸催化机制引发多次化学反应。</h4>
                            <h4 data-i18n="car_formula_math">CAR模型的四个关键步骤：</h4>
                            <ul>
                                <li data-i18n="car_formula_math_A"><b>光酸生成</b>：曝光产生初始光酸分布，与曝光剂量和量子效率有关</li>
                                <li data-i18n="car_formula_math_B"><b>光酸扩散</b>：后烘过程中光酸分子扩散，使空间分布变得平滑</li>
                                <li data-i18n="car_formula_math_C"><b>催化反应</b>：每个光酸分子可催化多个保护基团脱离，实现化学放大</li>
                                <li data-i18n="car_formula_math_D"><b>显影过程</b>：脱保护区域可被显影液溶解，形成图案</li>
                            </ul>
                            <p data-i18n="car_formula_simple">本模型关注放大效应、对比度和分辨率之间的关系。</p>
                            <h4 data-i18n="car_formula_detail">核心公式详解</h4>
                            <div class="formula-details-card inner-formula-card">
                                <div class="formula-card-body">
                                    <div class="formula-large" data-i18n="car_formula_acid"><code>[H<sup>+</sup>] = η · D(x) = η · I(x) · t<sub>exp</sub></code></div>
                                    <div class="formula-large" data-i18n="car_formula_deprotect"><code>M = 1 - e<sup>-k · [H<sup>+</sup>]<sub>diff</sub> · A</sup></code></div>
                                    <div class="formula-description">
                                        <div class="formula-param" data-i18n="car_formula_param_H"><span class="param-name">[H<sup>+</sup>]:</span> <span class="param-desc">光酸浓度，与曝光剂量成正比</span></div>
                                        <div class="formula-param" data-i18n="car_formula_param_eta"><span class="param-name">η:</span> <span class="param-desc">光酸产生效率，反映光子到光酸分子的转化效率</span></div>
                                        <div class="formula-param" data-i18n="car_formula_param_diff"><span class="param-name">[H<sup>+</sup>]<sub>diff:</span> <span class="param-desc">经过扩散后的光酸浓度分布</span></div>
                                        <div class="formula-param" data-i18n="car_formula_param_k"><span class="param-name">k:</span> <span class="param-desc">反应速率常数，表征催化反应效率</span></div>
                                        <div class="formula-param" data-i18n="car_formula_param_A"><span class="param-name">A:</span> <span class="param-desc">放大因子，表示每个光酸分子可以催化的反应数量</span></div>
                                        <div class="formula-param" data-i18n="car_formula_param_M"><span class="param-name">M:</span> <span class="param-desc">树脂脱保护程度，影响显影后的溶解速率</span></div>
                                    </div>
                                    <div class="formula-derivation">
                                        <h4 data-i18n="car_formula_steps">CAR模型步骤方程</h4>
                                        <p data-i18n="car_formula_steps_desc">CAR模型的完整反应过程可表示为：</p>
                                        <code data-i18n="car_formula_steps_1">1. [H<sup>+</sup>] = η · D(x) = η · I(x) · t<sub>exp</sub></code><br>
                                        <code data-i18n="car_formula_steps_2">2. [H<sup>+</sup>]<sub>diff</sub> = G([H<sup>+</sup>], l<sub>diff</sub>)</code><br>
                                        <code data-i18n="car_formula_steps_3">3. M = 1 - e<sup>-k · [H<sup>+</sup>]<sub>diff</sub> · A</sup></code>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
            
            <!-- 参数输入区域 -->
            <section class="parameters-section">
                <h2 class="section-title">参数设置</h2>
                
                <div id="dill-params" class="parameters-grid" style="display:block;">
                    <!-- Dill模型基本参数容器 -->
                    <div class="parameter-group-container" id="dill-basic-params-container" data-title="Dill模型基本参数" data-i18n-title="dill_basic_params">
                        <!-- 参数1: I_avg -->
                        <div class="parameter-item slider-fill">
                            <div class="parameter-label">
                                <span class="parameter-name">平均入射光强度 (I<sub>avg</sub>)</span>
                                
                                <span class="parameter-value">10</span>
                            </div>
                            <div class="parameter-input">
                                <input type="range" id="I_avg" class="slider" min="1" max="100" step="0.1" value="10" title="平均入射光强度滑块" aria-label="平均入射光强度">
                                <input type="number" class="number-input" value="10" min="1" max="100" step="0.1" title="平均入射光强度数值输入" aria-label="平均入射光强度数值">
                            </div>
                            <div class="parameter-description" data-i18n="param_desc_I_avg">平均入射光强度，单位：mW/cm²</div>
                        </div>
                        
                        <!-- 参数2: V -->
                        <div class="parameter-item slider-fill">
                            <div class="parameter-label">
                                <span class="parameter-name">干涉条纹可见度 (V)</span>
                                
                                <span class="parameter-value">0.8</span>
                            </div>
                            <div class="parameter-input">
                                <input type="range" id="V" class="slider" min="0" max="1" step="0.01" value="0.8" title="干涉条纹可见度滑块" aria-label="干涉条纹可见度">
                                <input type="number" class="number-input" value="0.8" min="0" max="1" step="0.01" title="干涉条纹可见度数值输入" aria-label="干涉条纹可见度数值">
                            </div>
                            <div class="parameter-description" data-i18n="param_desc_V">干涉条纹的对比度，范围：0-1</div>
                        </div>
                        
                        <!-- 参数3: K -->
                        <div class="parameter-item slider-fill">
                            <div class="parameter-label">
                                <span class="parameter-name">空间频率 (K)</span>
                                
                                <span class="parameter-value">2</span>
                            </div>
                            <div class="parameter-input">
                                <input type="range" id="K" class="slider" min="0.1" max="10" step="0.1" value="2" title="空间频率滑块" aria-label="空间频率">
                                <input type="number" class="number-input" value="2" min="0.1" max="10" step="0.1" title="空间频率数值输入" aria-label="空间频率数值">
                            </div>
                            <div class="parameter-description" data-i18n="param_desc_K">干涉条纹的空间频率，单位：rad/μm</div>
                        </div>
                        
                        <!-- 参数4: t_exp -->
                        <div class="parameter-item slider-fill">
                            <div class="parameter-label">
                                <span class="parameter-name">曝光时间 (t<sub>exp</sub>)</span>
                                
                                <span class="parameter-value">5</span>
                            </div>
                            <div class="parameter-input">
                                <input type="range" id="t_exp" class="slider" min="0.1" max="20" step="0.1" value="5" title="曝光时间滑块" aria-label="曝光时间">
                                <input type="number" class="number-input" value="5" min="0.1" max="20" step="0.1" title="曝光时间数值输入" aria-label="曝光时间数值">
                            </div>
                            <div class="parameter-description" data-i18n="param_desc_t_exp">总曝光时间，单位：秒</div>
                        </div>
                        
                        <!-- 参数5: C -->
                        <div class="parameter-item slider-fill">
                            <div class="parameter-label">
                                <span class="parameter-name">光敏速率常数 (C)</span>
                                
                                <span class="parameter-value">0.02</span>
                            </div>
                            <div class="parameter-input">
                                <input type="range" id="C" class="slider" min="0.001" max="0.1" step="0.001" value="0.02" title="光敏速率常数滑块" aria-label="光敏速率常数">
                                <input type="number" class="number-input" value="0.02" min="0.001" max="0.1" step="0.001" title="光敏速率常数数值输入" aria-label="光敏速率常数数值">
                            </div>
                            <div class="parameter-description" data-i18n="param_desc_C">光刻胶的Dill C参数，单位：cm²/mJ</div>
                        </div>
                    </div>

                    <!-- 修改Dill模型的正弦波类型选择框 -->
                    <div class="parameter-item sine-wave-type-container" id="dill-sine-type-container" data-title="波形类型" data-i18n-title="sine_wave_type">
                        <label for="dill-sine-type" data-i18n="sine_wave_type_label">正弦波类型：</label>
                        <select id="dill-sine-type" class="model-select">
                            <option value="single" selected data-i18n="sine_wave_type_single">一维正弦波</option>
                            <option value="multi" data-i18n="sine_wave_type_multi">二维正弦波</option>
                            <option value="3d" data-i18n="sine_wave_type_3d">三维正弦波</option>
                        </select>
                    </div>
                    <!-- 修改Dill模型的二维波形参数容器 -->
                    <div id="dill-multisine-params" class="sine-wave-params-container" data-title="二维波形参数" data-i18n-title="twod_sine_wave_params" style="display:none;">
                        <div class="parameter-item slider-fill">
                            <div class="parameter-label"><span class="parameter-name" data-i18n="kx_label">Kx (空间频率x)</span></div>
                            <div class="parameter-input"><input type="number" id="Kx" value="2" min="0.1" max="10" step="0.1"></div>
                            <div class="parameter-description" data-i18n="kx_description">x方向空间频率，单位：rad/μm，范围：0.1~10</div>
                        </div>
                        <div class="parameter-item slider-fill">
                            <div class="parameter-label"><span class="parameter-name" data-i18n="ky_label">Ky (空间频率y)</span></div>
                            <div class="parameter-input"><input type="number" id="Ky" value="1" min="0.1" max="100" step="0.1"></div>
                            <div class="parameter-description" data-i18n="ky_description">y方向空间频率，单位：rad/μm，范围：0.1~100（必须大于0）</div>
                        </div>
                        <div class="parameter-item slider-fill">
                            <div class="parameter-label"><span class="parameter-name" data-i18n="phi_label">φ(t) (相位表达式)</span></div>
                            <div class="parameter-input phi-expr-container">
                                <select id="phi_expr_select" class="phi-expr-select" title="选择常用相位表达式或使用自定义表达式">
                                    <option value="custom" data-i18n="phi_expr_custom">自定义输入</option>
                                    <option value="0" selected data-i18n="phi_expr_constant">常量: 0</option>
                                    <option value="0.5*t" data-i18n="phi_expr_linear">线性变化: 0.5*t</option>
                                    <option value="sin(t)" data-i18n="phi_expr_sin">正弦变化: sin(t)</option>
                                    <option value="cos(t)" data-i18n="phi_expr_cos">余弦变化: cos(t)</option>
                                    <option value="sin(2*PI*t)" data-i18n="phi_expr_sin_2pi">正弦周期变化: sin(2*PI*t)</option>
                                    <option value="0.2*t*t" data-i18n="phi_expr_quadratic">二次变化: 0.2*t*t</option>
                                    <option value="t*sin(2*PI*t)" data-i18n="phi_expr_complex1">复合函数: t*sin(2*PI*t)</option>
                                    <option value="exp(-0.1*t)*sin(t)" data-i18n="phi_expr_complex2">衰减正弦: exp(-0.1*t)*sin(t)</option>
                                    <option value="PI/4" data-i18n="phi_expr_pi4">固定相位: PI/4</option>
                                </select>
                                <i class="fas fa-question-circle phi-expr-help-icon"></i>
                                <div class="phi-expr-tooltip" data-i18n="phi_expr_help">支持数学函数: sin, cos, tan, exp, abs, sqrt, PI, E</div>
                                <input type="text" id="phi_expr" value="0" class="phi-expr-input" placeholder="输入相位表达式，可使用t,PI,sin,cos,exp等函数">
                            </div>
                            <div class="phi-expr-error" style="color:#d00;font-size:0.95em;display:none;"></div>
                            <button id="phi-expr-preview-btn" class="preview-button" style="margin-top:4px;display:none;">预览分布</button>
                            <div id="phi-expr-preview-plot" class="preview-plot preview-plot-2d" style="margin-top:8px;display:none;"></div>
                        </div>
                        <!-- Y范围参数，移到二维波形参数容器内 -->
                        <div class="parameter-item">
                            <div class="parameter-label"><span class="parameter-name" data-i18n="y_range_label">y范围 (μm)：</span></div>
                            <div class="parameter-input">
                                <input type="number" id="y_min" value="0" min="0" max="100" step="0.1"> ~
                                <input type="number" id="y_max" value="10" min="0" max="100" step="0.1">
                                <label data-i18n="y_resolution_label">分辨率：</label>
                                <input type="number" id="y_points" value="100" min="1" max="200" step="1">
                            </div>
                            <div class="parameter-description" data-i18n="y_range_description">二维分布时有效，y_min=y_max表示一维，y范围0~100，分辨率1~200</div>
                        </div>
                    </div>

                    <!-- 添加三维正弦波参数输入区域 -->
                    <div id="dill-3dsine-params" class="sine-wave-params-container" data-title="三维波形参数" data-i18n-title="3d_sine_wave_params" style="display:none;">
                        <div class="parameter-item slider-fill">
                            <div class="parameter-label"><span class="parameter-name" data-i18n="kx_label">Kx (空间频率x)</span></div>
                            <div class="parameter-input"><input type="number" id="Kx_3d" value="2" min="0.1" max="10" step="0.1"></div>
                            <div class="parameter-description" data-i18n="kx_description">x方向空间频率，单位：rad/μm，范围：0.1~10</div>
                        </div>
                        <div class="parameter-item slider-fill">
                            <div class="parameter-label"><span class="parameter-name" data-i18n="ky_label">Ky (空间频率y)</span></div>
                            <div class="parameter-input"><input type="number" id="Ky_3d" value="1" min="0.1" max="10" step="0.1"></div>
                            <div class="parameter-description" data-i18n="ky_description">y方向空间频率，单位：rad/μm，范围：0.1~10</div>
                        </div>
                        <div class="parameter-item slider-fill">
                            <div class="parameter-label"><span class="parameter-name" data-i18n="kz_label">Kz (空间频率z)</span></div>
                            <div class="parameter-input"><input type="number" id="Kz_3d" value="1" min="0.1" max="10" step="0.1"></div>
                            <div class="parameter-description" data-i18n="kz_description">z方向空间频率，单位：rad/μm，范围：0.1~10</div>
                        </div>
                        <div class="parameter-item slider-fill">
                            <div class="parameter-label"><span class="parameter-name" data-i18n="phi_label">φ(t) (相位表达式)</span></div>
                            <div class="parameter-input phi-expr-container">
                                <select id="phi_expr_3d_select" class="phi-expr-select" title="选择常用相位表达式或使用自定义表达式">
                                    <option value="custom" data-i18n="phi_expr_custom">自定义输入</option>
                                    <option value="0" selected data-i18n="phi_expr_constant">常量: 0</option>
                                    <option value="0.5*t" data-i18n="phi_expr_linear">线性变化: 0.5*t</option>
                                    <option value="sin(t)" data-i18n="phi_expr_sin">正弦变化: sin(t)</option>
                                    <option value="cos(t)" data-i18n="phi_expr_cos">余弦变化: cos(t)</option>
                                    <option value="sin(2*PI*t)" data-i18n="phi_expr_sin_2pi">正弦周期变化: sin(2*PI*t)</option>
                                    <option value="0.2*t*t" data-i18n="phi_expr_quadratic">二次变化: 0.2*t*t</option>
                                    <option value="t*sin(2*PI*t)" data-i18n="phi_expr_complex1">复合函数: t*sin(2*PI*t)</option>
                                    <option value="exp(-0.1*t)*sin(t)" data-i18n="phi_expr_complex2">衰减正弦: exp(-0.1*t)*sin(t)</option>
                                    <option value="PI/4" data-i18n="phi_expr_pi4">固定相位: PI/4</option>
                                </select>
                                <i class="fas fa-question-circle phi-expr-help-icon"></i>
                                <div class="phi-expr-tooltip" data-i18n="phi_expr_help">支持数学函数: sin, cos, tan, exp, abs, sqrt, PI, E</div>
                                <input type="text" id="phi_expr_3d" value="0" class="phi-expr-input" placeholder="输入相位表达式，可使用t,PI,sin,cos,exp等函数">
                            </div>
                            <div class="phi-expr-error" style="color:#d00;font-size:0.95em;display:none;"></div>
                            <button id="phi-expr-3d-preview-btn" class="preview-button" style="margin-top:4px;display:none;">预览3D分布</button>
                            <div id="phi-expr-3d-preview-plot" class="preview-plot preview-plot-3d" style="margin-top:8px;display:none;"></div>
                        </div>
                        <div class="parameter-item">
                            <div class="parameter-label"><span class="parameter-name" data-i18n="3d_range_label">三维显示范围</span></div>
                            <div class="parameter-input">
                                <div class="range-row">
                                    <label>X: </label>
                                    <input type="number" id="x_min_3d" value="0" min="0" max="100" step="0.1"> ~ 
                                    <input type="number" id="x_max_3d" value="10" min="0" max="100" step="0.1">
                                </div>
                                <div class="range-row">
                                    <label>Y: </label>
                                    <input type="number" id="y_min_3d" value="0" min="0" max="100" step="0.1"> ~ 
                                    <input type="number" id="y_max_3d" value="10" min="0" max="100" step="0.1">
                                </div>
                                <div class="range-row">
                                    <label>Z: </label>
                                    <input type="number" id="z_min_3d" value="0" min="0" max="100" step="0.1"> ~ 
                                    <input type="number" id="z_max_3d" value="10" min="0" max="100" step="0.1">
                                </div>
                            </div>
                            <div class="parameter-description" data-i18n="3d_range_description">三维分布显示范围，单位：μm</div>
                        </div>
                    </div>
                </div>
                
                <div id="enhanced-dill-params" class="parameters-grid" style="display:none;">
                    <!-- Enhanced Dill模型基本参数容器 -->
                    <div class="parameter-group-container" id="enhanced-dill-basic-params-container" data-title="增强Dill模型基本参数" data-i18n-title="enhanced_dill_basic_params">
                        <div class="parameter-item slider-fill">
                            <div class="parameter-label"><span class="parameter-name">胶厚 (z<sub>h</sub>, μm)</span><span class="parameter-value">10</span></div>
                            <div class="parameter-input"><input type="range" id="z_h" class="slider" min="1" max="50" step="0.1" value="10"><input type="number" class="number-input" value="10" min="1" max="50" step="0.1"></div>
                            <div class="parameter-description" data-i18n="param_desc_z_h">光刻胶厚度，单位：μm</div>
                        </div>
                        <div class="parameter-item slider-fill">
                            <div class="parameter-label"><span class="parameter-name">前烘温度 (T, ℃)</span><span class="parameter-value">100</span></div>
                            <div class="parameter-input"><input type="range" id="T" class="slider" min="60" max="150" step="1" value="100"><input type="number" class="number-input" value="100" min="60" max="150" step="1"></div>
                            <div class="parameter-description" data-i18n="param_desc_T">前烘温度，单位：℃</div>
                        </div>
                        <div class="parameter-item slider-fill">
                            <div class="parameter-label"><span class="parameter-name">前烘时间 (t<sub>B</sub>, min)</span><span class="parameter-value">10</span></div>
                            <div class="parameter-input"><input type="range" id="t_B" class="slider" min="1" max="60" step="1" value="10"><input type="number" class="number-input" value="10" min="1" max="60" step="1"></div>
                            <div class="parameter-description" data-i18n="param_desc_t_B">前烘时间，单位：分钟</div>
                        </div>
                        <div class="parameter-item slider-fill">
                            <div class="parameter-label"><span class="parameter-name">初始光强 (I<sub>0</sub>)</span><span class="parameter-value">1.0</span></div>
                            <div class="parameter-input"><input type="range" id="I0" class="slider" min="0.1" max="2" step="0.01" value="1.0"><input type="number" class="number-input" value="1.0" min="0.1" max="2" step="0.01"></div>
                            <div class="parameter-description" data-i18n="param_desc_I0">归一化初始光强</div>
                        </div>
                        <div class="parameter-item slider-fill">
                            <div class="parameter-label"><span class="parameter-name">初始PAC浓度 (M<sub>0</sub>)</span><span class="parameter-value">1.0</span></div>
                            <div class="parameter-input"><input type="range" id="M0" class="slider" min="0.1" max="1.0" step="0.01" value="1.0"><input type="number" class="number-input" value="1.0" min="0.1" max="1.0" step="0.01"></div>
                            <div class="parameter-description" data-i18n="param_desc_M0">归一化初始PAC浓度</div>
                        </div>
                        <div class="parameter-item slider-fill">
                            <div class="parameter-label"><span class="parameter-name">曝光时间 (t<sub>exp</sub>, s)</span><span class="parameter-value">5</span></div>
                            <div class="parameter-input"><input type="range" id="t_exp_enhanced" class="slider" min="0.1" max="60" step="0.1" value="5"><input type="number" class="number-input" value="5" min="0.1" max="60" step="0.1"></div>
                            <div class="parameter-description" data-i18n="param_desc_t_exp_enhanced">曝光时间，单位：秒</div>
                        </div>

                        <!-- 增强Dill模型1D模式的V和K参数 -->
                        <div class="parameter-item slider-fill">
                            <div class="parameter-label">
                                <span class="parameter-name">干涉条纹可见度 (V)</span>
                                <span class="parameter-value">0.8</span>
                            </div>
                            <div class="parameter-input">
                                <input type="range" id="enhanced_V" class="slider" min="0" max="1" step="0.01" value="0.8">
                                <input type="number" class="number-input" value="0.8" min="0" max="1" step="0.01">
                            </div>
                            <div class="parameter-description" data-i18n="param_desc_enhanced_V">1D模式下干涉条纹的对比度，范围：0-1</div>
                        </div>
                        
                        <div class="parameter-item slider-fill">
                            <div class="parameter-label">
                                <span class="parameter-name">空间频率 (K)</span>
                                <span class="parameter-value">2</span>
                            </div>
                            <div class="parameter-input">
                                <input type="range" id="enhanced_K" class="slider" min="0.1" max="10" step="0.1" value="2">
                                <input type="number" class="number-input" value="2" min="0.1" max="10" step="0.1">
                            </div>
                            <div class="parameter-description" data-i18n="param_desc_enhanced_K">1D模式下干涉条纹的空间频率，单位：rad/μm</div>
                        </div>
                    </div>

                    <!-- 修改Enhanced Dill模型的正弦波类型选择框 -->
                    <div class="parameter-item sine-wave-type-container" id="enhanced-dill-sine-type-container" data-title="波形类型" data-i18n-title="sine_wave_type">
                        <label for="enhanced-dill-sine-type" data-i18n="sine_wave_type_label">正弦波类型：</label>
                        <select id="enhanced-dill-sine-type" class="model-select">
                            <option value="single" selected data-i18n="sine_wave_type_single">一维正弦波</option>
                            <option value="multi" data-i18n="sine_wave_type_multi">二维正弦波</option>
                            <option value="3d" data-i18n="sine_wave_type_3d">三维正弦波</option>
                        </select>
                    </div>
                    <div id="enhanced-dill-multisine-params" class="sine-wave-params-container" data-title="二维波形参数" data-i18n-title="twod_sine_wave_params" style="display:none;">
                        <div class="parameter-item slider-fill">
                            <div class="parameter-label"><span class="parameter-name" data-i18n="kx_label">Kx (空间频率x)</span></div>
                            <div class="parameter-input"><input type="number" id="enhanced_Kx" value="2" min="0.1" max="10" step="0.1"></div>
                            <div class="parameter-description" data-i18n="kx_description">x方向空间频率，单位：rad/μm，范围：0.1~10</div>
                        </div>
                        <div class="parameter-item slider-fill">
                            <div class="parameter-label"><span class="parameter-name" data-i18n="ky_label">Ky (空间频率y)</span></div>
                            <div class="parameter-input"><input type="number" id="enhanced_Ky" value="1" min="0.1" max="100" step="0.1"></div>
                            <div class="parameter-description" data-i18n="ky_description">y方向空间频率，单位：rad/μm，范围：0.1~100（必须大于0）</div>
                        </div>
                        <div class="parameter-item slider-fill">
                            <div class="parameter-label"><span class="parameter-name" data-i18n="phi_label">φ(t) (相位表达式)</span></div>
                            <div class="parameter-input phi-expr-container">
                                <select id="enhanced_phi_expr_select" class="phi-expr-select" title="选择常用相位表达式或使用自定义表达式">
                                    <option value="custom" data-i18n="phi_expr_custom">自定义输入</option>
                                    <option value="0" selected data-i18n="phi_expr_constant">常量: 0</option>
                                    <option value="0.5*t" data-i18n="phi_expr_linear">线性变化: 0.5*t</option>
                                    <option value="sin(t)" data-i18n="phi_expr_sin">正弦变化: sin(t)</option>
                                    <option value="cos(t)" data-i18n="phi_expr_cos">余弦变化: cos(t)</option>
                                    <option value="sin(2*PI*t)" data-i18n="phi_expr_sin_2pi">正弦周期变化: sin(2*PI*t)</option>
                                    <option value="0.2*t*t" data-i18n="phi_expr_quadratic">二次变化: 0.2*t*t</option>
                                    <option value="t*sin(2*PI*t)" data-i18n="phi_expr_complex1">复合函数: t*sin(2*PI*t)</option>
                                    <option value="exp(-0.1*t)*sin(t)" data-i18n="phi_expr_complex2">衰减正弦: exp(-0.1*t)*sin(t)</option>
                                    <option value="PI/4" data-i18n="phi_expr_pi4">固定相位: PI/4</option>
                                </select>
                                <i class="fas fa-question-circle phi-expr-help-icon"></i>
                                <div class="phi-expr-tooltip" data-i18n="phi_expr_help">支持数学函数: sin, cos, tan, exp, abs, sqrt, PI, E</div>
                                <input type="text" id="enhanced_phi_expr" value="0" class="phi-expr-input" placeholder="输入相位表达式，可使用t,PI,sin,cos,exp等函数">
                            </div>
                            <div class="phi-expr-error" style="color:#d00;font-size:0.95em;display:none;"></div>
                            <button id="enhanced-phi-expr-preview-btn" class="preview-button" style="margin-top:4px;display:none;">预览分布</button>
                            <div id="enhanced-phi-expr-preview-plot" class="preview-plot preview-plot-2d" style="margin-top:8px;display:none;"></div>
                        </div>
                        <!-- Y范围参数，放在容器内部 -->
                        <div class="parameter-item">
                            <div class="parameter-label"><span class="parameter-name" data-i18n="y_range_label">y范围 (μm)：</span></div>
                            <div class="parameter-input">
                                <input type="number" id="enhanced_y_min" value="0" min="0" max="100" step="0.1"> ~
                                <input type="number" id="enhanced_y_max" value="10" min="0" max="100" step="0.1">
                                <label data-i18n="y_resolution_label">分辨率：</label>
                                <input type="number" id="enhanced_y_points" value="100" min="1" max="200" step="1">
                            </div>
                            <div class="parameter-description" data-i18n="y_range_description">二维分布时有效，y_min=y_max表示一维，y范围0~100，分辨率1~200</div>
                        </div>
                    </div>

                    <!-- 添加增强Dill模型的三维正弦波参数输入区域 -->
                    <div id="enhanced-dill-3dsine-params" class="sine-wave-params-container" data-title="三维波形参数" data-i18n-title="3d_sine_wave_params" style="display:none;">
                        <div class="parameter-item slider-fill">
                            <div class="parameter-label"><span class="parameter-name" data-i18n="kx_label">Kx (空间频率x)</span></div>
                            <div class="parameter-input"><input type="number" id="enhanced_Kx_3d" value="2" min="0.1" max="10" step="0.1"></div>
                            <div class="parameter-description" data-i18n="kx_description">x方向空间频率，单位：rad/μm，范围：0.1~10</div>
                        </div>
                        <div class="parameter-item slider-fill">
                            <div class="parameter-label"><span class="parameter-name" data-i18n="ky_label">Ky (空间频率y)</span></div>
                            <div class="parameter-input"><input type="number" id="enhanced_Ky_3d" value="1" min="0.1" max="10" step="0.1"></div>
                            <div class="parameter-description" data-i18n="ky_description">y方向空间频率，单位：rad/μm，范围：0.1~10</div>
                        </div>
                        <div class="parameter-item slider-fill">
                            <div class="parameter-label"><span class="parameter-name" data-i18n="kz_label">Kz (空间频率z)</span></div>
                            <div class="parameter-input"><input type="number" id="enhanced_Kz_3d" value="1" min="0.1" max="10" step="0.1"></div>
                            <div class="parameter-description" data-i18n="kz_description">z方向空间频率，单位：rad/μm，范围：0.1~10</div>
                        </div>
                        <div class="parameter-item slider-fill">
                            <div class="parameter-label"><span class="parameter-name" data-i18n="phi_label">φ(t) (相位表达式)</span></div>
                            <div class="parameter-input phi-expr-container">
                                <select id="enhanced_phi_expr_3d_select" class="phi-expr-select" title="选择常用相位表达式或使用自定义表达式">
                                    <option value="custom" data-i18n="phi_expr_custom">自定义输入</option>
                                    <option value="0" selected data-i18n="phi_expr_constant">常量: 0</option>
                                    <option value="0.5*t" data-i18n="phi_expr_linear">线性变化: 0.5*t</option>
                                    <option value="sin(t)" data-i18n="phi_expr_sin">正弦变化: sin(t)</option>
                                    <option value="cos(t)" data-i18n="phi_expr_cos">余弦变化: cos(t)</option>
                                    <option value="sin(2*PI*t)" data-i18n="phi_expr_sin_2pi">正弦周期变化: sin(2*PI*t)</option>
                                    <option value="0.2*t*t" data-i18n="phi_expr_quadratic">二次变化: 0.2*t*t</option>
                                </select>
                                <input type="text" id="enhanced_phi_expr_3d" value="0" class="phi-expr-input">
                            </div>
                            <div class="phi-expr-error" style="color:#d00;font-size:0.95em;display:none;"></div>
                            <button id="enhanced-phi-expr-3d-preview-btn" class="preview-button" style="margin-top:4px;display:none;">预览3D分布</button>
                            <div id="enhanced-phi-expr-3d-preview-plot" class="preview-plot preview-plot-3d" style="margin-top:8px;display:none;"></div>
                        </div>
                        <div class="parameter-item">
                            <div class="parameter-label"><span class="parameter-name" data-i18n="3d_range_label">三维显示范围</span></div>
                            <div class="parameter-input">
                                <div class="range-row">
                                    <label>X: </label>
                                    <input type="number" id="enhanced_x_min_3d" value="0" min="0" max="100" step="0.1"> ~ 
                                    <input type="number" id="enhanced_x_max_3d" value="10" min="0" max="100" step="0.1">
                                </div>
                                <div class="range-row">
                                    <label>Y: </label>
                                    <input type="number" id="enhanced_y_min_3d" value="0" min="0" max="100" step="0.1"> ~ 
                                    <input type="number" id="enhanced_y_max_3d" value="10" min="0" max="100" step="0.1">
                                </div>
                                <div class="range-row">
                                    <label>Z: </label>
                                    <input type="number" id="enhanced_z_min_3d" value="0" min="0" max="100" step="0.1"> ~ 
                                    <input type="number" id="enhanced_z_max_3d" value="10" min="0" max="100" step="0.1">
                                </div>
                            </div>
                            <div class="parameter-description" data-i18n="3d_range_description">三维分布显示范围，单位：μm</div>
                        </div>
                    </div>
                </div>
                
                <div id="car-params" class="car-params parameters-grid" style="display:none;">
                    <!-- CAR模型基本参数容器 -->
                    <div class="parameter-group-container" id="car-basic-params-container" data-title="CAR模型基本参数" data-i18n-title="car_basic_params">
                        <!-- 参数1: I_avg -->
                        <div class="parameter-item slider-fill">
                            <div class="parameter-label">
                                <span class="parameter-name">平均入射光强度 (I<sub>avg</sub>)</span>
                                
                                <span class="parameter-value">10</span>
                            </div>
                            <div class="parameter-input">
                                <input type="range" id="car_I_avg" class="slider" min="1" max="100" step="0.1" value="10">
                                <input type="number" class="number-input" value="10" min="1" max="100" step="0.1">
                            </div>
                            <div class="parameter-description" data-i18n="param_desc_car_I_avg">平均入射光强度，单位：mW/cm²</div>
                        </div>
                        
                        <!-- 参数2: V -->
                        <div class="parameter-item slider-fill">
                            <div class="parameter-label">
                                <span class="parameter-name">干涉条纹可见度 (V)</span>
                                
                                <span class="parameter-value">0.8</span>
                            </div>
                            <div class="parameter-input">
                                <input type="range" id="car_V" class="slider" min="0" max="1" step="0.01" value="0.8">
                                <input type="number" class="number-input" value="0.8" min="0" max="1" step="0.01">
                            </div>
                            <div class="parameter-description" data-i18n="param_desc_car_V">干涉条纹的对比度，范围：0-1</div>
                        </div>
                        
                        <!-- 参数3: K -->
                        <div class="parameter-item slider-fill">
                            <div class="parameter-label">
                                <span class="parameter-name">空间频率 (K)</span>
                                
                                <span class="parameter-value">2</span>
                            </div>
                            <div class="parameter-input">
                                <input type="range" id="car_K" class="slider" min="0.1" max="10" step="0.1" value="2">
                                <input type="number" class="number-input" value="2" min="0.1" max="10" step="0.1">
                            </div>
                            <div class="parameter-description" data-i18n="param_desc_car_K">干涉条纹的空间频率，单位：rad/μm</div>
                        </div>
                        
                        <!-- 参数4: t_exp -->
                        <div class="parameter-item slider-fill">
                            <div class="parameter-label">
                                <span class="parameter-name">曝光时间 (t<sub>exp</sub>)</span>
                                
                                <span class="parameter-value">5</span>
                            </div>
                            <div class="parameter-input">
                                <input type="range" id="car_t_exp" class="slider" min="0.1" max="20" step="0.1" value="5">
                                <input type="number" class="number-input" value="5" min="0.1" max="20" step="0.1">
                            </div>
                            <div class="parameter-description" data-i18n="param_desc_car_t_exp">总曝光时间，单位：秒</div>
                        </div>
                        
                        <!-- 参数5: acid_gen_efficiency -->
                        <div class="parameter-item slider-fill">
                            <div class="parameter-label">
                                <span class="parameter-name">光酸产生效率 (η)</span>
                                
                                <span class="parameter-value">0.5</span>
                            </div>
                            <div class="parameter-input">
                                <input type="range" id="car_acid_gen_efficiency" class="slider" min="0.01" max="1" step="0.01" value="0.5">
                                <input type="number" class="number-input" value="0.5" min="0.01" max="1" step="0.01">
                            </div>
                            <div class="parameter-description" data-i18n="param_desc_car_acid_gen">光子到光酸分子的转化效率，范围：0-1</div>
                        </div>
                        
                        <!-- 参数6: diffusion_length -->
                        <div class="parameter-item slider-fill">
                            <div class="parameter-label">
                                <span class="parameter-name">扩散长度 (EPDL)</span>
                                
                                <span class="parameter-value">3</span>
                            </div>
                            <div class="parameter-input">
                                <input type="range" id="car_diffusion_length" class="slider" min="0" max="20" step="0.1" value="3">
                                <input type="number" class="number-input" value="3" min="0" max="20" step="0.1">
                            </div>
                            <div class="parameter-description" data-i18n="param_desc_car_diff">光酸扩散长度，单位：像素</div>
                        </div>
                        
                        <!-- 参数7: reaction_rate -->
                        <div class="parameter-item slider-fill">
                            <div class="parameter-label">
                                <span class="parameter-name">反应速率常数 (k)</span>
                                
                                <span class="parameter-value">0.3</span>
                            </div>
                            <div class="parameter-input">
                                <input type="range" id="car_reaction_rate" class="slider" min="0.01" max="1" step="0.01" value="0.3">
                                <input type="number" class="number-input" value="0.3" min="0.01" max="1" step="0.01">
                            </div>
                            <div class="parameter-description" data-i18n="param_desc_car_rate">催化反应速率常数</div>
                        </div>
                        
                        <!-- 参数8: amplification -->
                        <div class="parameter-item slider-fill">
                            <div class="parameter-label">
                                <span class="parameter-name">放大因子 (A)</span>
                                
                                <span class="parameter-value">10</span>
                            </div>
                            <div class="parameter-input">
                                <input type="range" id="car_amplification" class="slider" min="1" max="50" step="0.5" value="10">
                                <input type="number" class="number-input" value="10" min="1" max="50" step="0.5">
                            </div>
                            <div class="parameter-description" data-i18n="param_desc_car_amp">每个光酸分子可催化的反应数</div>
                        </div>
                        
                        <!-- 参数9: contrast -->
                        <div class="parameter-item slider-fill">
                            <div class="parameter-label">
                                <span class="parameter-name">对比度因子 (γ)</span>
                                
                                <span class="parameter-value">3</span>
                            </div>
                            <div class="parameter-input">
                                <input type="range" id="car_contrast" class="slider" min="0.1" max="10" step="0.1" value="3">
                                <input type="number" class="number-input" value="3" min="0.1" max="10" step="0.1">
                            </div>
                            <div class="parameter-description" data-i18n="param_desc_car_contrast">显影过程的对比度系数</div>
                        </div>
                    </div>

                    <!-- 修改CAR模型的正弦波类型选择框 -->
                    <div class="parameter-item sine-wave-type-container" id="car-sine-type-container" data-title="波形类型" data-i18n-title="sine_wave_type">
                        <label for="car-sine-type" data-i18n="sine_wave_type_label">正弦波类型：</label>
                        <select id="car-sine-type" class="model-select">
                            <option value="single" selected data-i18n="sine_wave_type_single">一维正弦波</option>
                            <option value="multi" data-i18n="sine_wave_type_multi">二维正弦波</option>
                            <option value="3d" data-i18n="sine_wave_type_3d">三维正弦波</option>
                        </select>
                    </div>
                    <div id="car-multisine-params" class="sine-wave-params-container" data-title="二维波形参数" data-i18n-title="twod_sine_wave_params" style="display:none;">
                        <div class="parameter-item slider-fill">
                            <div class="parameter-label"><span class="parameter-name" data-i18n="kx_label">Kx (空间频率x)</span></div>
                            <div class="parameter-input"><input type="number" id="car_Kx" value="2" min="0.1" max="10" step="0.1"></div>
                            <div class="parameter-description" data-i18n="kx_description">x方向空间频率，单位：rad/μm，范围：0.1~10</div>
                        </div>
                        <div class="parameter-item slider-fill">
                            <div class="parameter-label"><span class="parameter-name" data-i18n="ky_label">Ky (空间频率y)</span></div>
                            <div class="parameter-input"><input type="number" id="car_Ky" value="1" min="0.1" max="100" step="0.1"></div>
                            <div class="parameter-description" data-i18n="ky_description">y方向空间频率，单位：rad/μm，范围：0.1~100（必须大于0）</div>
                        </div>
                        <div class="parameter-item slider-fill">
                            <div class="parameter-label"><span class="parameter-name" data-i18n="phi_label">φ(t) (相位表达式)</span></div>
                            <div class="parameter-input phi-expr-container">
                                <select id="car_phi_expr_select" class="phi-expr-select" title="选择常用相位表达式或使用自定义表达式">
                                    <option value="custom" data-i18n="phi_expr_custom">自定义输入</option>
                                    <option value="0" selected data-i18n="phi_expr_constant">常量: 0</option>
                                    <option value="0.5*t" data-i18n="phi_expr_linear">线性变化: 0.5*t</option>
                                    <option value="sin(t)" data-i18n="phi_expr_sin">正弦变化: sin(t)</option>
                                    <option value="cos(t)" data-i18n="phi_expr_cos">余弦变化: cos(t)</option>
                                    <option value="sin(2*PI*t)" data-i18n="phi_expr_sin_2pi">正弦周期变化: sin(2*PI*t)</option>
                                    <option value="0.2*t*t" data-i18n="phi_expr_quadratic">二次变化: 0.2*t*t</option>
                                    <option value="t*sin(2*PI*t)" data-i18n="phi_expr_complex1">复合函数: t*sin(2*PI*t)</option>
                                    <option value="exp(-0.1*t)*sin(t)" data-i18n="phi_expr_complex2">衰减正弦: exp(-0.1*t)*sin(t)</option>
                                    <option value="PI/4" data-i18n="phi_expr_pi4">固定相位: PI/4</option>
                                </select>
                                <i class="fas fa-question-circle phi-expr-help-icon"></i>
                                <div class="phi-expr-tooltip" data-i18n="phi_expr_help">支持数学函数: sin, cos, tan, exp, abs, sqrt, PI, E</div>
                                <input type="text" id="car_phi_expr" value="0" class="phi-expr-input" placeholder="输入相位表达式，可使用t,PI,sin,cos,exp等函数">
                            </div>
                            <div class="phi-expr-error" style="color:#d00;font-size:0.95em;display:none;"></div>
                            <button id="car-phi-expr-preview-btn" class="preview-button" style="margin-top:4px;display:none;">预览分布</button>
                            <div id="car-phi-expr-preview-plot" class="preview-plot preview-plot-2d" style="margin-top:8px;display:none;"></div>
                        </div>
                        <!-- Y范围参数，放在容器内部 -->
                        <div class="parameter-item">
                            <div class="parameter-label"><span class="parameter-name" data-i18n="y_range_label">y范围 (μm)：</span></div>
                            <div class="parameter-input">
                                <input type="number" id="car_y_min" value="0" min="0" max="100" step="0.1"> ~
                                <input type="number" id="car_y_max" value="10" min="0" max="100" step="0.1">
                                <label data-i18n="y_resolution_label">分辨率：</label>
                                <input type="number" id="car_y_points" value="100" min="1" max="200" step="1">
                            </div>
                            <div class="parameter-description" data-i18n="y_range_description">二维分布时有效，y_min=y_max表示一维，y范围0~100，分辨率1~200</div>
                        </div>
                    </div>

                    <!-- 添加CAR模型的三维正弦波参数输入区域 -->
                    <div id="car-3dsine-params" class="sine-wave-params-container" data-title="三维波形参数" data-i18n-title="3d_sine_wave_params" style="display:none;">
                        <div class="parameter-item slider-fill">
                            <div class="parameter-label"><span class="parameter-name" data-i18n="car_kx_label">Kx (空间频率x)</span></div>
                            <div class="parameter-input"><input type="number" id="car_Kx_3d" value="2" min="0.1" max="10" step="0.1"></div>
                            <div class="parameter-description" data-i18n="car_kx_description">x方向空间频率，单位：rad/μm，范围：0.1~10</div>
                        </div>
                        <div class="parameter-item slider-fill">
                            <div class="parameter-label"><span class="parameter-name" data-i18n="car_ky_label">Ky (空间频率y)</span></div>
                            <div class="parameter-input"><input type="number" id="car_Ky_3d" value="1" min="0.1" max="10" step="0.1"></div>
                            <div class="parameter-description" data-i18n="car_ky_description">y方向空间频率，单位：rad/μm，范围：0.1~10</div>
                        </div>
                        <div class="parameter-item slider-fill">
                            <div class="parameter-label"><span class="parameter-name" data-i18n="car_kz_label">Kz (空间频率z)</span></div>
                            <div class="parameter-input"><input type="number" id="car_Kz_3d" value="1" min="0.1" max="10" step="0.1"></div>
                            <div class="parameter-description" data-i18n="car_kz_description">z方向空间频率，单位：rad/μm，范围：0.1~10</div>
                        </div>
                        <div class="parameter-item slider-fill">
                            <div class="parameter-label"><span class="parameter-name" data-i18n="car_phi_label">φ(t) (相位表达式)</span></div>
                            <div class="parameter-input phi-expr-container">
                                <select id="car_phi_expr_3d_select" class="phi-expr-select" title="选择常用相位表达式或使用自定义表达式">
                                    <option value="custom" data-i18n="phi_expr_custom">自定义输入</option>
                                    <option value="0" selected data-i18n="phi_expr_constant">常量: 0</option>
                                    <option value="0.5*t" data-i18n="phi_expr_linear">线性变化: 0.5*t</option>
                                    <option value="sin(t)" data-i18n="phi_expr_sin">正弦变化: sin(t)</option>
                                    <option value="cos(t)" data-i18n="phi_expr_cos">余弦变化: cos(t)</option>
                                    <option value="sin(2*PI*t)" data-i18n="phi_expr_sin_2pi">正弦周期变化: sin(2*PI*t)</option>
                                    <option value="0.2*t*t" data-i18n="phi_expr_quadratic">二次变化: 0.2*t*t</option>
                                    <option value="t*sin(2*PI*t)" data-i18n="phi_expr_complex1">复合函数: t*sin(2*PI*t)</option>
                                    <option value="exp(-0.1*t)*sin(t)" data-i18n="phi_expr_complex2">衰减正弦: exp(-0.1*t)*sin(t)</option>
                                    <option value="PI/4" data-i18n="phi_expr_pi4">固定相位: PI/4</option>
                                </select>
                                <i class="fas fa-question-circle phi-expr-help-icon"></i>
                                <div class="phi-expr-tooltip" data-i18n="phi_expr_help">支持数学函数: sin, cos, tan, exp, abs, sqrt, PI, E</div>
                                <input type="text" id="car_phi_expr_3d" value="0" class="phi-expr-input" placeholder="输入相位表达式，可使用t,PI,sin,cos,exp等函数">
                            </div>
                            <div class="phi-expr-error" style="color:#d00;font-size:0.95em;display:none;"></div>
                            <button id="car-phi-expr-3d-preview-btn" class="preview-button" style="margin-top:4px;display:none;">预览3D分布</button>
                            <div id="car-phi-expr-3d-preview-plot" class="preview-plot preview-plot-3d" style="margin-top:8px;display:none;"></div>
                        </div>
                        <div class="parameter-item">
                            <div class="parameter-label"><span class="parameter-name" data-i18n="car_3d_range_label">三维显示范围</span></div>
                            <div class="parameter-input">
                                <div class="range-row">
                                    <label>X: </label>
                                    <input type="number" id="car_x_min_3d" value="0" min="0" max="100" step="0.1"> ~ 
                                    <input type="number" id="car_x_max_3d" value="10" min="0" max="100" step="0.1">
                                </div>
                                <div class="range-row">
                                    <label>Y: </label>
                                    <input type="number" id="car_y_min_3d" value="0" min="0" max="100" step="0.1"> ~ 
                                    <input type="number" id="car_y_max_3d" value="10" min="0" max="100" step="0.1">
                                </div>
                                <div class="range-row">
                                    <label>Z: </label>
                                    <input type="number" id="car_z_min_3d" value="0" min="0" max="100" step="0.1"> ~ 
                                    <input type="number" id="car_z_max_3d" value="10" min="0" max="100" step="0.1">
                                </div>
                            </div>
                            <div class="parameter-description" data-i18n="car_3d_range_description">三维分布显示范围，单位：μm</div>
                        </div>
                    </div>
                </div>
                
                <div class="button-container">
                    <button id="calculate-btn" class="calculate-btn" data-i18n="calculate">计算</button>
                </div>
            </section>
            
            <!-- 结果展示区域 -->
            <section id="results-section" class="results-section">
                <div class="section-header">
                    <h2 class="section-title" data-i18n="result_section">计算结果</h2>
                    <button id="view-logs-btn" class="view-logs-btn" title="查看详细计算日志" data-i18n-title="view_logs_title">
                        <i class="fas fa-file-alt"></i>
                        <span data-i18n="view_logs">查看日志</span>
                    </button>
                </div>
                
                <div class="plots-container">
                    <!-- 新增(X, Y)平面曝光剂量热力图 -->
                    <div class="plot-item" id="exposure-xy-plot-item" style="display:none;">
                        <h3 class="plot-title">曝光计量分布 (2D) (X, Y平面)</h3>
                        <div id="exposure-xy-plot-container" class="plot-container"></div>
                        <div class="plot-export-btns">
                            <button id="export-exposure-xy-img">导出图片</button>
                            <button id="export-exposure-xy-data">导出数据</button>
                        </div>
                    </div>
                    
                    <!-- 新增(X, Y)平面光刻胶厚度热力图 -->
                    <div class="plot-item" id="thickness-xy-plot-item" style="display:none;">
                        <h3 class="plot-title">光刻胶厚度分布 (2D) (X, Y平面)</h3>
                        <div id="thickness-xy-plot-container" class="plot-container"></div>
                        <div class="plot-export-btns">
                            <button id="export-thickness-xy-img">导出图片</button>
                            <button id="export-thickness-xy-data">导出数据</button>
                        </div>
                    </div>

                    <!-- 曝光剂量分布图 -->
                    <div class="plot-item">
                        <h3 class="plot-title" data-i18n="exposure_dist">曝光计量分布 (1D)</h3>
                        <div id="exposure-plot-container" class="plot-container"></div>
                        <div class="individual-threshold-controls threshold-analysis-hint" id="exposure-thresholds-container">
                          <div class="threshold-control" data-idx="0">
                            <span class="threshold-label-text">曝光剂量阈值:</span>
                            <input type="range" class="threshold-slider" min="10" max="200" step="1" value="80" title="曝光剂量阈值滑块" aria-label="曝光剂量阈值">
                            <span class="threshold-value-text">80 mJ/cm²</span>
                            <button class="toggle-threshold-visibility-btn">显示</button>
                          </div>
                        </div>
                        <div class="plot-export-btns">
                            <button id="export-exposure-img" data-i18n="export_img">导出图片</button>
                            <button id="export-exposure-data" data-i18n="export_data">导出数据</button>
                        </div>
                        <!-- 保留原有图像作为后备 -->
                        <img id="exposure-plot" class="plot-image" style="display: none;" src="" alt="曝光剂量分布图">
                    </div>
                    
                    <!-- 光刻胶厚度分布图 -->
                    <div class="plot-item">
                        <h3 class="plot-title" data-i18n="thickness_dist">光刻胶厚度分布 (1D)</h3>
                        <div id="thickness-plot-container" class="plot-container"></div>
                        <div class="individual-threshold-controls threshold-analysis-hint" id="thickness-thresholds-container">
                          <div class="threshold-control" data-idx="0">
                            <span class="threshold-label-text">厚度阈值:</span>
                            <input type="range" class="threshold-slider" min="0" max="1" step="0.01" value="0.3" title="厚度阈值滑块" aria-label="厚度阈值">
                            <span class="threshold-value-text">0.3</span>
                            <button class="toggle-threshold-visibility-btn">显示</button>
                          </div>
                        </div>
                        <div class="plot-export-btns">
                            <button id="export-thickness-img" data-i18n="export_img">导出图片</button>
                            <button id="export-thickness-data" data-i18n="export_data">导出数据</button>
                        </div>
                        <!-- 保留原有图像作为后备 -->
                        <img id="thickness-plot" class="plot-image" style="display: none;" src="" alt="光刻胶厚度分布图">
                    </div>

                    <!-- 结果区增加二维热力图展示区域 -->
                    <div class="plot-item" id="heatmap-plot-item" style="display:none;">
                        <h3 class="plot-title" data-i18n="heatmap_plot_title">二维分布热力图</h3>
                        <div id="heatmap-plot-container" class="plot-container"></div>
                        <button id="export-heatmap-data" data-i18n="export_heatmap_data_btn">导出二维数据</button>
                    </div>
                </div>

                <!-- CAR模型交互式图表区域 -->
                <div id="car-interactive-plots" class="car-results-container" style="display: none;"></div>
                <div id="car-results" class="car-results-container" style="display: none;"></div>
            </section>
        </div>
    </main>
    
    <!-- 日志查看弹窗 -->
    <div id="logs-modal" class="modal" aria-modal="true" role="dialog">
        <div class="modal-content logs-modal-content">
            <div class="modal-header">
                <h3 class="modal-title">
                    <i class="fas fa-file-alt"></i> 计算运行日志
                </h3>
                <div class="modal-controls">
                    <select id="log-model-filter" class="log-filter-select" title="过滤模型类型" aria-label="过滤模型类型">
                        <option value="">所有模型</option>
                        <option value="dill">Dill模型</option>
                        <option value="enhanced_dill">Enhanced Dill模型</option>
                        <option value="car">CAR模型</option>
                        <option value="system">系统</option>
                    </select>
                    <button id="refresh-logs-btn" class="log-control-btn" title="刷新日志">
                        <i class="fas fa-sync-alt"></i>
                    </button>
                    <button id="clear-logs-btn" class="log-control-btn" title="清空日志">
                        <i class="fas fa-trash"></i>
                    </button>
                    <button id="close-logs-modal" class="close-modal-btn" title="关闭">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
            </div>
            <div class="modal-body">
                <div id="logs-container" class="logs-container">
                    <div class="logs-loading">
                        <i class="fas fa-spinner fa-spin"></i> 加载日志中...
                    </div>
                </div>
            </div>
            <div class="logs-stats">
                <span id="logs-count-info" class="logs-count">总计: 0 条日志</span>
            </div>
        </div>
    </div>
    
    <!-- 页脚 -->
    <footer>
        <div class="footer-content">
            <p>&copy; 2025 香港大学 版权所有.</p>
        </div>
    </footer>
    
    <!-- 引入JavaScript文件 -->
    <script src="js/common.js?v=1.0"></script>
    <script src="js/lang.js"></script>
    <script src="js/main.js"></script>
    <script src="js/car-model.js?v=1.0"></script>
    <script src="js/logs-manager.js"></script>
    <script>
    // 模型切换逻辑
    const modelSelect = document.getElementById('model-select');
    const dillDesc = document.getElementById('dill-desc');
    const enhancedDillDesc = document.getElementById('enhanced-dill-desc');
    const carDesc = document.getElementById('car-desc');
    const dillParams = document.getElementById('dill-params');
    const enhancedDillParams = document.getElementById('enhanced-dill-params');
    const carParams = document.getElementById('car-params');
    const carInteractivePlots = document.getElementById('car-interactive-plots');
    const carResults = document.getElementById('car-results');
    
    // 设置主题颜色函数
    function applyThemeColor(modelType) {
        // 首先移除所有主题类
        document.body.classList.remove('theme-dill', 'theme-enhanced-dill', 'theme-car');
        
        // 然后添加选中的主题类
        if (modelType === 'dill') {
            document.body.classList.add('theme-dill');
        } else if (modelType === 'enhanced_dill') {
            document.body.classList.add('theme-enhanced-dill');
        } else if (modelType === 'car') {
            document.body.classList.add('theme-car');
        }
    }
    
    // 在页面加载时应用默认主题
    document.addEventListener('DOMContentLoaded', function() {
        applyThemeColor(modelSelect.value);
    });
    
    modelSelect.addEventListener('change', function() {
        if (this.value === 'dill') {
            dillDesc.style.display = 'block';
            enhancedDillDesc.style.display = 'none';
            carDesc.style.display = 'none';
            dillParams.style.display = 'block';
            enhancedDillParams.style.display = 'none';
            carParams.style.display = 'none';
            carInteractivePlots.style.display = 'none';
            carResults.style.display = 'none';
            applyThemeColor('dill'); // 应用Dill模型主题
        } else if (this.value === 'enhanced_dill') {
            dillDesc.style.display = 'none';
            enhancedDillDesc.style.display = 'block';
            carDesc.style.display = 'none';
            dillParams.style.display = 'none';
            enhancedDillParams.style.display = 'block';
            carParams.style.display = 'none';
            carInteractivePlots.style.display = 'none';
            carResults.style.display = 'none';
            applyThemeColor('enhanced_dill'); // 应用增强Dill模型主题
        } else if (this.value === 'car') {
            dillDesc.style.display = 'none';
            enhancedDillDesc.style.display = 'none';
            carDesc.style.display = 'block';
            dillParams.style.display = 'none';
            enhancedDillParams.style.display = 'none';
            carParams.style.display = 'block';
            carInteractivePlots.style.display = 'block';
            carResults.style.display = 'block';
            applyThemeColor('car'); // 应用CAR模型主题
        }
    });
    
    // 展开更多详情按钮事件
    const dillToggleBtn = document.getElementById('dill-toggle-details');
    const enhancedDillToggleBtn = document.getElementById('enhanced-dill-toggle-details');
    const carToggleBtn = document.getElementById('car-toggle-details');
    const dillFullDetails = document.getElementById('dill-full-details');
    const enhancedDillFullDetails = document.getElementById('enhanced-dill-full-details');
    const carFullDetails = document.getElementById('car-full-details');
    
    dillToggleBtn.addEventListener('click', function() {
        const isVisible = dillFullDetails.classList.contains('details-visible');
        if (isVisible) {
            dillFullDetails.classList.remove('details-visible');
            this.innerHTML = LANGS[currentLang].btn_expand;
        } else {
            dillFullDetails.classList.add('details-visible');
            this.innerHTML = LANGS[currentLang].btn_collapse;
        }
    });
    
    enhancedDillToggleBtn.addEventListener('click', function() {
        const isVisible = enhancedDillFullDetails.classList.contains('details-visible');
        if (isVisible) {
            enhancedDillFullDetails.classList.remove('details-visible');
            this.innerHTML = LANGS[currentLang].btn_expand;
        } else {
            enhancedDillFullDetails.classList.add('details-visible');
            this.innerHTML = LANGS[currentLang].btn_collapse;
        }
    });
    
    carToggleBtn.addEventListener('click', function() {
        const isVisible = carFullDetails.classList.contains('details-visible');
        if (isVisible) {
            carFullDetails.classList.remove('details-visible');
            this.innerHTML = LANGS[currentLang].btn_expand;
        } else {
            carFullDetails.classList.add('details-visible');
            this.innerHTML = LANGS[currentLang].btn_collapse;
        }
    });
    </script>
</body>
</html> 